<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="renderer" content="webkit">
    <title>电力服务云平台</title>
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <link rel="icon" href="${rc.contextPath}/statics/img/favicon.ico">
    <link rel="stylesheet" href="${rc.contextPath}/statics/css/normalize.css">
    <link rel="stylesheet" href="${rc.contextPath}/statics/css/font-awesome.min.css">
    <link rel="stylesheet" href="${rc.contextPath}/statics/css/main.css">
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!--[if lte IE 8]>
    <script>window.location.href = 'http://cdn.dmeng.net/upgrade-your-browser.html?referrer=' + location.href;</script>
    <![endif]-->
    <!--[if lte IE 7]>
    <script>window.location.href = 'http://cdn.dmeng.net/upgrade-your-browser.html?referrer=' + location.href;</script>
    <![endif]-->
    <!--[if lte IE 6]>
    <script>window.location.href = 'http://cdn.dmeng.net/upgrade-your-browser.html?referrer=' + location.href;</script>
    <![endif]-->
</head>

<body class="hold-transition">
    <div id="rrapp" class="main-container">
        <tabs>
            <tab name="首页"></tab>
            <tab name="需求市场" :selected="tabSelected == 'requirement'">
                <span class="news-title">首页</span>><span>{{ title }}</span>>需求详情
                <div style="text-align: center;">
                    <div class="requirement-detail">
                        <h2>***一号配电房</h2>
                        <p class="requirement-detail-date">
                            需求编号: 2222322222
                        </p>
                        <p style="text-indent: 2em;font-size: 14px;margin: 35px 0;">
                            需求描述需求描述需求描述需求描述需求描述需求描述需求描述需求描述需求描述需求描述需求描述需求描述需求描述需求描述
                        </p>
                        <img class="upload-img requirement-detail-img" src="${rc.contextPath}/statics/img/ad-test-1.png" v-for="item in 3" @click="imgEnlarge" />
                        <p class="requirement-detail-date">
                            截止时间: 2017/09/05
                        </p>
                        <p class="requirement-detail-date">发布时间: 2017/09/06</p>
                        <p class="requirement-detail-date">工作时间: 2017/09/04---2017/09/09</p>
                    </div>
                    <div>
                        <button type="button" class="requirement-detail-btn">响应</button>
                    </div>
                </div>
            </tab>
            <tab name="行业资讯" :selected="tabSelected == 'news'">
                <span class="news-title">首页</span>><span>{{ title }}</span>>
                <span>${details.title}</span>
                <div class="newsdetail-content">
                    <div class="newsdetail-news-title">
                        <span class="news-title-text">${details.title}</span>
                        <hr class="news-title-hr">
                        <span class="news-title-date">${details.publishTime}</span>
                    </div>
                    <div style="margin-top: 25px;">
                        <p style="text-indent: 2em">
                            ${details.content}
                        </p>
                    </div>
                </div>
            </tab>
            <tab name="公告消息" :selected="tabSelected == 'annc'">
                <span class="news-title news-title-detail">首页</span>><span>{{ title }}</span>>
                <span>${details.title}</span>
                <div class="newsList-content newsDetail-content">
                    <div class="newsDetail-annc-title">
                        <span class="newsDetail-annc-title-text">${details.title}</span>
                    </div>
                    <div style="padding: 1em 1em;background-color: #fff;">
                        ${details.content}
                    </div>
                </div>
            </tab>
        </tabs>
    </div>
    <!-- <div id="mainOtherTel" class="main-other">
    <div class="main-other-part">
        <img src="${rc.contextPath}/statics/img/main-icon-tel.png"/>
        <span class="main-other-text">专家热线/客服电话</span>
    </div>
</div>
<div id="mainOtherHelp" class="main-other">
    <div class="main-other-part">
        <img src="${rc.contextPath}/statics/img/main-icon-help.png"/>
        <span class="main-other-text">帮助中心</span>
    </div>
</div> -->
    <footer class="main-footer main-footer-news">
        <span>电牛科技版权所有 2004-2017 ICP证： 浙B2-20150087</span>
    </footer>
    <script src="${rc.contextPath}/statics/libs/jquery.min.js"></script>
    <script src="${rc.contextPath}/statics/libs/vue.min.js"></script>
    <script src="${rc.contextPath}/statics/plugins/layer/layer.js"></script>
    <script type="text/javascript">
    'use strict';
    var mytabs = ['<div class="main-tab">',
        '   <div class="tabs news-tab news-tab-detail" style="display:flex;">',
        '   <figure  style="display: inline-block;text-align:center;margin: 1em 0;">',
        '   <a href="../../index.html" style="text-decoration: none;border-bottom: none;padding:0;padding-right:2em;" class="news-logo-detail">',
        '     <img src="${rc.contextPath}/statics/img/logo-news.png" style="max-width: 150px;">',
        '   </a>',
        '   </figure>',
        '     <ul style="border: none;display: inline-block;">',
        '       <li v-for="tab in tabs" :class="{\'is-active\': tab.isActive}" @click="tab.toggleTap" style="display: inline-block;">',
        '           <a :id="tab.id">{{ tab.name }}</a>',
        '       </li>',
        '     </ul>',
        '   </div>',
        '   <div class="tab-detail">',
        '       <slot></slot>',
        '   </div>',
        '</div>'
    ].join("");

    var mytab = ['<div v-show="isActive" class="tab-content">',
        '   <slot></slot>',
        '</div>'
    ].join("");
    //设置
    Vue.component('tabs', {
        template: mytabs,
        data: function data() {
            return {
                tabs: []
            };
        },
        created: function created() {
            this.tabs = this.$children;
        },

        methods: {
            selectedTab: function(_selectedTab) {
                this.tabs.forEach(function(tab) {
                    /*tab.isActive = tab.name === _selectedTab.name;*/
                });
            }
        }
    });
    Vue.component('tab', {
        props: {
            name: {
                required: true
            },
            selected: {
                default: false
            },
            id: {
                required: true
            }
        },
        template: mytab,
        data: function() {
            return {
                isActive: false
            };
        },
        methods: {
            toggleTap: function() {
                switch (this.name) {
                    case '首页':
                        window.location.href = '../../index.html';
                        break;
                    case '需求市场':
                        window.location.href = '../index.html?requirement';
                        break;
                    case '行业资讯':
                        window.location.href = '../index.html?news';
                        break;
                    case '公告消息':
                        window.location.href = '../index.html?annc';
                        break;
                }
            },
            
        },
        mounted: function() {
            this.isActive = this.selected;
        }
    });

    var vm = new Vue({
        el: '#rrapp',
        data: {
            title: '行业资讯',
            tabSelected: 'requirement'
        },
        beforeCreate: function() {
            if (self != top) {
                top.location.href = self.location.href;
            }
        },
        methods: {
            imgEnlarge: function(e) {
                var afterSrc = e.target.src;
                var cont = '';
                var last = afterSrc.lastIndexOf('_');
                var imgName = afterSrc.substring(0, last);
                var imgFormat = afterSrc.substring(last + 1, afterSrc.length).split('.')[1];
                var size = afterSrc.substring(last + 1, afterSrc.length).split('.')[0];
                var xSize = size.split('x')[0];
                var ySize = size.split('x')[1];
                if (xSize == ySize) {
                    afterSrc = imgName + '.' + imgFormat;
                }
                cont = '<div class="enlargeDiv"><img style="max-width: 700px;max-height: 450px;padding:15px;vertical-align: middle;" src="' + afterSrc + '"></div>';
                layer.open({
                    type: 1,
                    title: false,
                    closeBtn: 2,
                    area: ['700px', '450px'],
                    content: cont
                })
            }
        },
        created: function() {
            var type = window.location.href.split('?')[1];
            switch (type) {
                case 'requirement':
                    this.tabSelected = 'requirement';
                    break;
                    case 'news':
                        this.tabSelected = 'news';
                        break;
                    case 'annc':
                        $('body').addClass('body-bg');
                        $('html').addClass('body-bg');
                        this.tabSelected = 'annc';
                        break;
            }
            var getTab = localStorage.getItem('from');
            switch (getTab) {
                case 'news':
                    this.tabSelected = 'news';
                    break;
                case 'annc':
                    $('body').addClass('body-bg');
                    $('html').addClass('body-bg');
                    this.tabSelected = 'annc';
                    break;
            }
            localStorage.removeItem('tabSelected');
        }
    });
    // Create a safe reference to the Underscore object for use below.
    var _ = function(obj) {
        if (obj instanceof _) return obj;
        if (!(this instanceof _)) return new _(obj);
        this._wrapped = obj;
    };
    // A (possibly faster) way to get the current timestamp as an integer.
    _.now = Date.now || function() {
        return new Date().getTime();
    };
    _.throttle = function(func, wait, options) {
        var context, args, result;
        var timeout = null;
        var previous = 0;
        if (!options) options = {};
        var later = function() {
            previous = options.leading === false ? 0 : _.now();
            timeout = null;
            result = func.apply(context, args);
            if (!timeout) context = args = null;
        };
        return function() {
            var now = _.now();
            if (!previous && options.leading === false) previous = now;
            var remaining = wait - (now - previous);
            context = this;
            args = arguments;
            if (remaining <= 0 || remaining > wait) {
                if (timeout) {
                    clearTimeout(timeout);
                    timeout = null;
                }
                previous = now;
                result = func.apply(context, args);
                if (!timeout) context = args = null;
            } else if (!timeout && options.trailing !== false) {
                timeout = setTimeout(later, remaining);
            }
            return result;
        };
    };

    function setTop() {
        var winHeight = $(window).height();
        var eleHeight = winHeight / 2 - 25;
        $('#mainOtherHelp').css('top', eleHeight + 'px');
        $('#mainOtherTel').css('top', eleHeight - 50 + 'px');
        $('#mainOtherAbout').css('top', eleHeight + 50 + 'px');
    }

    function addOtherText() {
        $(this).find('.main-other-text').css('display', 'inline-block');
    }

    function removeOtherTest() {
        $(this).find('.main-other-text').css('display', 'none');
    }

    $(document).ready(function() {
        var winHeight = $(window).height();
        $('.newsList-content').css('min-height', winHeight / 3 * 2 + 'px');
        setTop();
    });
    var throttledTop = _.throttle(setTop, 200);
    $(window).resize(throttledTop);
    $('.main-other').on('mouseover', addOtherText);
    $('.main-other').on('mouseout', removeOtherTest);
    </script>
</body>

</html>